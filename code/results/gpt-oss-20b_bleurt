import pandas as pd
df = pd.read_csv('filename.csv')

!git clone https://github.com/google-research/bleurt.git
%cd bleurt
!pip install .

!wget https://storage.googleapis.com/bleurt-oss-21/BLEURT-20.zip .
!unzip BLEURT-20.zip

from bleurt import score

def calculate_bleurt(candidate, reference):
  scorer = score.BleurtScorer(checkpoint = 'BLEURT-20')
  bleurt_score = scorer.score(references=[reference], candidates=[candidate])
  return bleurt_score

bleurt_scores = []
for i in range(len(df)):
  bleurt_score = calculate_bleurt(candidate = candidate, reference = reference)
  bleurt_scores.append(bleurt_score)

df['bleurt_score'] = bleurt_scores
df.to_csv('filenamewithbleurt.csv', index = False)
df['bleurt_score'] = df['bleurt_score'].astype(str).str.strip("[]").astype(float)
average_score = df['bleurt_score'].sum() / len(table)
